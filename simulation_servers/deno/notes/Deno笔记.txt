Denoï¼ˆè¯»éŸ³ï¼š/ËˆdiËnoÊŠ/ï¼‰ç¬”è®°



å½“åœ¨deno.jsoné…ç½®æ–‡ä»¶ä¸­æŒ‡å®šâ€œimportsâ€æˆ–â€œscopesâ€æ—¶ï¼Œå°†å¿½ç•¥â€œimportMapâ€è®¾ç½®ã€‚



ä½¿ç”¨æŒ‡ä»¤è§£å†³ linting é—®é¢˜
// deno-lint-ignore no-explicit-any
ç›®å‰ï¼Œæ„å»ºè¿‡ç¨‹ä½¿ç”¨ dlint æ¥éªŒè¯ä»£ç ä¸­çš„ linting é—®é¢˜ã€‚å¦‚æœä»»åŠ¡éœ€è¦ä¸ç¬¦åˆ linter çš„ä»£ç ï¼Œè¯·ä½¿ç”¨ deno-lint-ignore <code> æŒ‡ä»¤æ¥æŠ‘åˆ¶è­¦å‘Šã€‚



å®‰è£…çš„ï¼š
deno install https://deno.land/x/corejs/index.js
deno install https://deno.land/std/crypto/mod.ts

deno install https://deno.land/std/media_types/mod.ts

deno install https://deno.land/x/chalk_deno/source/index.js

deno install https://deno.land/std/http/server.ts

deno install https://deno.land/x/dejs/mod.ts

deno install https://esm.sh/preact
deno install https://esm.sh/preact/jsx-runtime

deno install https://cdn.skypack.dev/preact/jsx-dev-runtime
deno install https://cdn.skypack.dev/preact/jsx-runtime

deno install https://esm.sh/linkedom

deno install https://deno.land/x/deno_dom/deno-dom-wasm-noinit.ts
deno install https://deno.land/x/deno_dom/deno-dom-wasm.ts
deno install https://deno.land/x/deno_dom/deno-dom-native.ts

deno install https://esm.sh/jsdom

deno install https://esm.sh/css
deno install https://deno.land/x/css/mod.ts

deno install https://esm.sh/twind
deno install https://esm.sh/twind/sheets

deno install https://deno.land/x/mysql/mod.ts
deno install https://deno.land/x/postgresjs/mod.js
deno install https://deno.land/x/mongo/mod.ts
deno install https://deno.land/x/sqlite3/mod.ts
deno install https://deno.land/x/sqlite/mod.ts

deno install https://esm.sh/firestore
???deno install https://www.gstatic.com/firebasejs/9.8.1/firebase-auth.js
???deno install https://www.gstatic.com/firebasejs/9.8.1/firebase-firestore.js
???deno install https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js

deno install https://esm.sh/@supabase/supabase-js

deno install https://deno.land/x/denodb/mod.ts

deno install https://deno.land/x/gql/mod.ts
deno install https://deno.land/x/graphql_tools/mod.ts
deno install https://deno.land/x/graphql_tag/mod.ts
deno install https://esm.sh/graphql

deno install https://deno.land/std/dotenv/mod.ts
deno install https://deno.land/std/flags/mod.ts

deno install https://deno.land/std/testing/asserts.ts

deno install https://deno.land/std/streams/mod.ts
deno install https://deno.land/std/streams/conversion.ts
deno install https://deno.land/std/http/file_server.ts



å…³äºdeno.jsonä¸­çš„å‡ ä¸ªè·Ÿå®˜æ–¹é»˜è®¤é…ç½®ä¸ä¸€æ ·çš„é€‰é¡¹è¯´æ˜ï¼š
è‡ªå®šä¹‰çš„ï¼Œå®˜æ–¹é»˜è®¤éƒ½æ˜¯falseã€‚
"noFallthroughCasesInSwitch": true,
"noImplicitReturns": true,
"useUnknownInCatchVariables": true,
"noUnusedLocals": true,
"noUnusedParameters": true,

å®˜æ–¹é»˜è®¤æ˜¯falseï¼Œå½“â€œ--check=allâ€æ—¶ï¼Œè¯¥é€‰é¡¹ä¸ºtrueæ—¶ï¼ŒæŸäº›ç¬¬ä¸‰æ–¹åº“ä¼šæŠ¥ç±»å‹é”™è¯¯ã€‚
"noUncheckedIndexedAccess": true,

å®˜æ–¹é»˜è®¤æ˜¯trueï¼Œå®é™…è¿è¡Œæ—¶ï¼Œå‘ç°ä¸ºtrueæ—¶ä¼šæŠ¥é”™ï¼šerror: TS5053 [ERROR]: Option 'noImplicitUseStrict' cannot be specified with option 'alwaysStrict'.ä½†æ˜¯â€œalwaysStrictâ€é€‰é¡¹ä¸è¢«æ”¯æŒï¼Œä¼šè¢«å¿½ç•¥ã€‚
å…³äºnoImplicitUseStricté€‰é¡¹ï¼š
ç¦æ­¢åœ¨å‘å‡ºçš„JavaScriptæ–‡ä»¶ä¸­æ·»åŠ "use strict"æŒ‡ä»¤ã€‚
ä½ ä¸åº”è¯¥éœ€è¦è¿™ä¸ªã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“å‘éES6ç›®æ ‡å‘å‡ºæ¨¡å—æ–‡ä»¶æ—¶ï¼ŒTypeScriptå‘å‡º"use strict"ï¼›æ–‡ä»¶é¡¶éƒ¨çš„åºè¨€ã€‚æ­¤è®¾ç½®ç¦ç”¨åºè¨€ã€‚
"noImplicitUseStrict": false,

å…³äºalwaysStricté€‰é¡¹ï¼š
ç¡®ä¿æ‚¨çš„æ–‡ä»¶åœ¨ECMAScriptä¸¥æ ¼æ¨¡å¼ä¸‹è§£æï¼Œå¹¶ä¸ºæ¯ä¸ªæºæ–‡ä»¶å‘å‡ºâ€œuse strictâ€ã€‚
é»˜è®¤å€¼:
å¦‚æœstricté€‰é¡¹ä¸ºtrueï¼Œåˆ™å®ƒä¹Ÿæ˜¯trueï¼Œå¦åˆ™ä¸ºfalseã€‚



deno upgrade
è¦æ›´æ–°Denoçš„å…ˆå‰å®‰è£…çš„ç‰ˆæœ¬ï¼Œå¯ä»¥è¿è¡Œdeno upgradeã€‚è¿™å°†ä»github.com/denoland/deno/releasesè·å–æœ€æ–°ç‰ˆæœ¬ ï¼Œè§£å‹ç¼©å¹¶ç”¨å®ƒæ›¿æ¢å½“å‰çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚



ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼š
DENO_DIRï¼šè¿™å°†è®¾ç½®å­˜å‚¨æ¥è‡ªCLIçš„ç¼“å­˜ä¿¡æ¯çš„ç›®å½•ã€‚è¿™åŒ…æ‹¬ç¼“å­˜çš„è¿œç¨‹æ¨¡å—ã€ç¼“å­˜çš„è½¬è¯‘æ¨¡å—ã€è¯­è¨€æœåŠ¡å™¨ç¼“å­˜ä¿¡æ¯å’Œæœ¬åœ°å­˜å‚¨ä¸­çš„æŒä¹…æ•°æ®ç­‰é¡¹ç›®ã€‚
è¿™é»˜è®¤ä¸ºæ“ä½œç³»ç»Ÿé»˜è®¤ç¼“å­˜ä½ç½®ï¼Œç„¶ååœ¨denoè·¯å¾„ä¸‹ã€‚
DENO_INSTALL_ROOTï¼šä½¿ç”¨deno installæ—¶ï¼Œå·²å®‰è£…è„šæœ¬çš„å­˜å‚¨ä½ç½®ã€‚è¿™é»˜è®¤ä¸º$HOME/.deno/binã€‚
DENO_WEBGPU_TRACEï¼šç”¨äºWebGPUè·Ÿè¸ªçš„ç›®å½•ã€‚

// DENO_DIR ä½ç½®
DENO_DIR location: D:\Deno\App\Dir
// è¿œç¨‹æ¨¡å—ç¼“å­˜
Remote modules cache: D:\Deno\App\Dir\deps
// npm æ¨¡å—ç¼“å­˜
npm modules cache: D:\Deno\App\Dir\npm
// å‘å°„æ¨¡å—ç¼“å­˜
Emitted modules cache: D:\Deno\App\Dir\gen
// è¯­è¨€æœåŠ¡å™¨æ³¨å†Œè¡¨ç¼“å­˜
Language server registries cache: D:\Deno\App\Dir\registries
// åŸå§‹å­˜å‚¨
Origin storage: D:\Deno\App\Dir\location_data



ç›®å‰denoæä¾›çš„æ ‡å‡†çš„åº“æ–‡ä»¶ï¼Œå¦‚ï¼š
ä½¿ç”¨æŒ‡å®šæ˜ç¡®çš„ç‰ˆæœ¬ï¼š
https://deno.land/std@0.161.0/streams/conversion.ts
ä½¿ç”¨ä¸æŒ‡å®šæ˜ç¡®çš„ç‰ˆæœ¬ï¼ˆå®é™…æ‰§è¡Œæ—¶ï¼Œä¼šç›´æ¥é»˜è®¤ä½¿ç”¨æœ€æ–°latestç‰ˆæœ¬ï¼‰ï¼š
https://deno.land/std/streams/conversion.ts
ä»£ç ï¼Œå¦‚ï¼š
import { copy } from "https://deno.land/std@0.161.0/streams/conversion.ts";



å…³äºä»£ç ä¸­çš„Deno.args
ä¾‹å­1ï¼š
deno run main.ts a b -c --quiet
// main.ts
console.log(Deno.args); // [ "a", "b", "-c", "--quiet" ]
ä¾‹å­2ï¼š
deno run -c --quiet main.ts a b
// main.ts
console.log(Deno.args); // [ "a", "b" ]
æ‰€ä»¥ï¼Œä¼ ç»™denoç”¨çš„ä»»ä½•å‚æ•°ï¼Œåº”è¯¥æ”¾åœ¨â€œmain.tsâ€ä¹‹å‰ï¼Œè€Œä¼ ç»™â€œmain.tsâ€çš„å‚æ•°åˆ™æ”¾åœ¨â€œmain.tsâ€ä¹‹åã€‚



--watchï¼Œå½±å“ï¼ˆä¹Ÿå°±æ˜¯è¯´å¯ä»¥åœ¨è¿™å‡ ä¸ªå­å‘½ä»¤ä¸­ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å‚æ•°æ ‡è¯†ï¼‰ï¼šdeno runã€deno testã€deno bundleå’Œdeno fmtè¿™å‡ ä¸ªå­å‘½ä»¤ã€‚
æ‚¨å¯ä»¥ä¸ºdeno runã€deno testã€deno bundleå’Œdeno fmtæä¾›--watchæ ‡å¿—ä»¥å¯ç”¨å†…ç½®æ–‡ä»¶è§‚å¯Ÿå™¨ã€‚ç›‘è§†çš„æ–‡ä»¶å–å†³äºä½¿ç”¨çš„å­å‘½ä»¤ï¼š
å¯¹äºdeno runã€deno testã€deno bundleçš„å…¥å£ç‚¹ï¼Œå°†ç›‘è§†å…¥å£ç‚¹é™æ€å¯¼å…¥çš„æ‰€æœ‰æœ¬åœ°æ–‡ä»¶ã€‚
å¯¹äºdeno fmtï¼Œæ‰€æœ‰æŒ‡å®šä¸ºå‘½ä»¤è¡Œå‚æ•°çš„æœ¬åœ°æ–‡ä»¶å’Œç›®å½•ï¼ˆå¦‚æœæ²¡æœ‰ä¼ é€’ç‰¹å®šæ–‡ä»¶/ç›®å½•ï¼Œåˆ™ä¸ºå·¥ä½œç›®å½•ï¼‰è¢«ç›‘è§†ã€‚
æ¯å½“åœ¨ç£ç›˜ä¸Šæ›´æ”¹ä¸€ä¸ªç›‘è§†æ–‡ä»¶æ—¶ï¼Œç¨‹åºå°†è‡ªåŠ¨é‡æ–°å¯åŠ¨/æ ¼å¼åŒ–/æµ‹è¯•/æ†ç»‘ã€‚
deno run --watch main.ts
deno test --watch
deno fmt --watch



å®Œæ•´æ€§æ ‡å¿—ï¼ˆé”å®šæ–‡ä»¶ï¼‰ï¼Œå½±å“ï¼ˆä¹Ÿå°±æ˜¯è¯´å¯ä»¥åœ¨è¿™å‡ ä¸ªå­å‘½ä»¤ä¸­ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å‚æ•°æ ‡è¯†ï¼‰ï¼šdeno cacheã€deno runã€deno testã€deno bundleã€deno docã€deno compileè¿™å‡ ä¸ªå­å‘½ä»¤ã€‚
å½±å“å¯ä»¥å°†èµ„æºä¸‹è½½åˆ°ç¼“å­˜çš„å‘½ä»¤ï¼šdeno cacheã€deno runã€deno testã€deno bundleã€deno docã€deno compileã€‚
--lock <FILE>ï¼šæ£€æŸ¥æŒ‡å®šçš„é”æ–‡ä»¶ã€‚
--lock-writeï¼šå†™é”æ–‡ä»¶ã€‚ä¸--lockä¸€èµ·ä½¿ç”¨ã€‚
è¯¦ç»†è§ï¼š
https://deno.land/manual@v1.27.0/linking_to_external_code/integrity_checking



å½±å“å¯ä»¥å¡«å……ç¼“å­˜çš„å‘½ä»¤ï¼šdeno cacheã€deno runã€deno testã€deno bundleã€deno doc å’Œ deno compileã€‚é™¤äº†ä¸Šé¢çš„æ ‡å¿—ï¼Œè¿™åŒ…æ‹¬å½±å“æ¨¡å—åˆ†è¾¨ç‡ã€ç¼–è¯‘é…ç½®ç­‰çš„æ ‡å¿—ã€‚
--config <FILE>               åŠ è½½é…ç½®æ–‡ä»¶
--import-map <FILE>           åŠ è½½å¯¼å…¥mapæ–‡ä»¶
--no-remote                   ä¸è§£æè¿œç¨‹æ¨¡å—
--reload=<CACHE_BLOCKLIST>    é‡æ–°åŠ è½½æºä»£ç ç¼“å­˜ï¼ˆé‡æ–°ç¼–è¯‘ TypeScriptï¼‰
è¿œç¨‹ä»£ç æ˜¯åœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶è·å–å¹¶ç¼“å­˜çš„ï¼Œå¹¶ä¸”ç›´åˆ°ä»£ç ä¸è¯¥--reloadæ ‡å¿—ä¸€èµ·è¿è¡Œæ—¶æ‰æ›´æ–°ã€‚ï¼ˆå› æ­¤ï¼Œä¸ä½¿ç”¨--reloadæ—¶ï¼Œè¢«ç¼“å­˜ä¸‹æ¥çš„ä»£ç ä»ç„¶å¯ä»¥åœ¨ç¦»çº¿æ—¶ä½¿ç”¨ã€‚ï¼‰
ä»è¿œç¨‹URLåŠ è½½çš„æ¨¡å—/æ–‡ä»¶æ—¨åœ¨ä¿æŒä¸å˜å’Œå¯ç¼“å­˜ã€‚
PS:
deno run --reload http://localhost:8081/WebProTpl/dist/Deno4TestA.js
--unstable                    å¯ç”¨ä¸ç¨³å®šçš„ API
ä½¿ç”¨â€œ--unstableâ€æ—¶ï¼Œä¿è¯åœ¨é…ç½®æ–‡ä»¶ä¸­çš„"lib"é€‰é¡¹ä¸­å¿…é¡»åŒ…å«"deno.window", "deno.unstable" è¿™ä¸¤ä¸ªç±»å‹æè¿°æ–‡ä»¶ã€‚


å½±å“æ‰§è¡Œç”¨æˆ·ä»£ç çš„å‘½ä»¤ï¼Œdeno runå’Œdeno testï¼š
--check
å¯¹ä»£ç è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚
è¯¥æ ‡å¿—å½±å“deno runã€deno evalã€deno replã€deno cacheã€‚
è¦ä¸ºæ‰€æœ‰æ¨¡å—æ‰“å¼€ç±»å‹æ£€æŸ¥ï¼Œè¯·ä½¿ç”¨--check=allã€‚
ä¸‹è¡¨æè¿°äº†å„ç§å­å‘½ä»¤çš„ç±»å‹æ£€æŸ¥è¡Œä¸ºã€‚è¿™é‡Œçš„â€œLocalâ€æ„å‘³ç€åªæœ‰æ¥è‡ªæœ¬åœ°ä»£ç çš„é”™è¯¯æ‰ä¼šå¯¼è‡´ç±»å‹é”™è¯¯ï¼Œä» https URLï¼ˆè¿œç¨‹ï¼‰å¯¼å…¥çš„æ¨¡å—å¯èƒ½ä¼šå‡ºç°æœªæŠ¥å‘Šçš„ç±»å‹é”™è¯¯ã€‚
å­å‘½ä»¤	       ç±»å‹æ£€æŸ¥æ¨¡å¼
deno bench	   ğŸ“ Local
deno bundle	   ğŸ“ Local
deno cache	   âŒ None
deno check	   ğŸ“ Local
deno compile   ğŸ“ Local
deno eval	   âŒ None
deno repl	   âŒ None
deno run	   âŒ None
deno test	   ğŸ“ Local
ä¾‹å¦‚ï¼š
æ‚¨è¿˜å¯ä»¥åœ¨æ‰§è¡Œå‰å¯¹ä»£ç è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œæ–¹æ³•æ˜¯ä½¿ç”¨ --check å‚æ•°è¿›è¡Œdeno runï¼š
deno run --check main.ts
è¿˜æœ‰ä¸€ä¸ªè·³è¿‡ç±»å‹æ£€æŸ¥çš„å‘½ä»¤ï¼š--no-check=remote
å…¶ä¸­å‚æ•°remoteï¼Œå¯ä»¥è®¾ç½®å“ªäº›è¿œç¨‹ã€æœ¬åœ°æ–‡ä»¶è·³è¿‡ç±»å‹æ£€æŸ¥
--no-check=https://deno.land/std@0.137.0/bytes/bytes_list.ts,https://deno.land/std@0.137.0/io/buffer.ts,https://deno.land/std@0.137.0/testing/_diff.ts
ä½†æ˜¯--no-check=[,,,]ä¸èƒ½è·Ÿ--check=allä¸€èµ·ä½¿ç”¨ã€‚
ä¾‹å­ï¼š
deno run -A --watch --config=./deno.json --lock-write --unstable --prompt --check --v8-flags=--max-old-space-size=8192 --reload ./src/App.mts --color=16m
è¿™ç§å†™æ³•ï¼Œåªä¼šå¯¹è‡ªå·±ç¼–å†™çš„ä»£ç åšç±»å‹æ£€æŸ¥ï¼Œä¸ä¼šå¯¹ç¬¬ä¸‰æ–¹çš„ä»£ç åšç±»å‹æ£€æŸ¥ã€‚



å…¶ä»–è¿è¡Œæ—¶æ ‡å¿—ï¼Œæ›´å¤šå½±å“æ‰§è¡Œç¯å¢ƒçš„æ ‡å¿—ã€‚
--cached-only                è¦æ±‚å·²ç»ç¼“å­˜äº†è¿œç¨‹ä¾èµ–é¡¹
--inspect=<HOST:PORT>        åœ¨ä¸»æœºä¸Šæ¿€æ´»æ£€æŸ¥å™¨ï¼šç«¯å£ ...
--inspect-brk=<HOST:PORT>    æ¿€æ´»ä¸»æœºä¸Šçš„æ£€æŸ¥å™¨ï¼šç«¯å£å¹¶åœ¨...ä¸­æ–­
--location <HREF>            æŸäº› Web API ä½¿ç”¨çš„â€œglobalThis.locationâ€çš„å€¼
--prompt                     å¦‚æœæœªé€šè¿‡æ‰€éœ€çš„æƒé™ï¼Œåˆ™å›é€€ä»¥æç¤ºã€‚
--seed <NUMBER>              Seed Math.random()
--v8-flags=<v8-flags>        Set V8 command line options. For help: ...



é…ç½®æ–‡ä»¶ï¼š--config deno.json
Deno æ”¯æŒé…ç½®æ–‡ä»¶ï¼Œå…è®¸è‡ªå®šä¹‰å†…ç½®çš„ TypeScript ç¼–è¯‘å™¨ã€æ ¼å¼åŒ–ç¨‹åºå’Œ linterã€‚
é…ç½®æ–‡ä»¶æ”¯æŒ .json å’Œ .jsonc æ‰©å±•åã€‚ä» v1.18 å¼€å§‹ï¼ŒDeno å°†è‡ªåŠ¨æ£€æµ‹ deno.json æˆ– deno.jsonc é…ç½®æ–‡ä»¶æ˜¯å¦åœ¨æ‚¨å½“å‰çš„å·¥ä½œç›®å½•ï¼ˆæˆ–çˆ¶ç›®å½•ï¼‰ä¸­ã€‚
è¦æ‰‹åŠ¨å‘Šè¯‰ Deno ä½¿ç”¨ç‰¹å®šçš„é…ç½®æ–‡ä»¶ï¼Œè¯·ä¼ é€’ --config path/to/file.json æ ‡å¿—ã€‚
ä» Deno v1.22 å¼€å§‹ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä¼ é€’ --no-config æ¥ç¦ç”¨é…ç½®æ–‡ä»¶çš„è‡ªåŠ¨æ£€æµ‹ã€‚
è¯·æ³¨æ„ï¼Œç°åœ¨ä¸éœ€è¦ä½¿ç”¨é…ç½®æ–‡ä»¶ï¼Œå°†æ¥ä¹Ÿä¸éœ€è¦ã€‚ Deno ä»ç„¶åœ¨é»˜è®¤é€‰é¡¹å’Œæ²¡æœ‰é…ç½®æ–‡ä»¶çš„æƒ…å†µä¸‹å·¥ä½œå¾—æœ€å¥½ã€‚
é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šçš„æ‰€æœ‰é€‰é¡¹ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œæ ‡å¿—è®¾ç½®ï¼ˆä¾‹å¦‚ --options-use-tabs ç”¨äº deno fmtï¼‰ã€‚
ä½¿ç”¨é…ç½®æ–‡ä»¶åº”è¯¥è¢«è®¤ä¸ºæ˜¯â€œæŒ‰éœ€â€åŠŸèƒ½ï¼Œè€Œä¸æ˜¯æ¯ä¸ªç”¨æˆ·åœ¨è®¾ç½®é¡¹ç›®æ—¶éƒ½åº”è¯¥é¦–å…ˆä½¿ç”¨çš„åŠŸèƒ½ã€‚
é…ç½®æ–‡ä»¶çš„åè®®è§ï¼š
https://deno.land/x/deno/cli/schemas/config-file.v1.json



æƒé™åˆ—è¡¨ï¼š
--allow-env=<allow-env>ï¼šå…è®¸ç¯å¢ƒè®¿é—®ï¼Œä¾‹å¦‚è·å–å’Œè®¾ç½®ç¯å¢ƒå˜é‡ã€‚ä» Deno 1.9 å¼€å§‹ï¼Œæ‚¨å¯ä»¥æŒ‡å®šä¸€ä¸ªå¯é€‰çš„ã€ä»¥é€—å·åˆ†éš”çš„ç¯å¢ƒå˜é‡åˆ—è¡¨ï¼Œä»¥æä¾›å…è®¸çš„ç¯å¢ƒå˜é‡çš„å…è®¸åˆ—è¡¨ã€‚
ä¾‹å­ï¼š
--allow-env=HOMEã€--allow-envï¼ˆè¡¨ç¤ºå…è®¸æ‰€æœ‰çš„ï¼‰
// env.js
Deno.env.get("HOME");
Windowsç”¨æˆ·æ³¨æ„äº‹é¡¹ï¼šç¯å¢ƒå˜é‡åœ¨Windowsä¸Šä¸åŒºåˆ†å¤§å°å†™ï¼Œå› æ­¤Denoä¹Ÿä¼šä¸åŒºåˆ†å¤§å°å†™åŒ¹é…å®ƒä»¬ï¼ˆä»…åœ¨Windowsä¸Šï¼‰ã€‚

--allow-hrtimeï¼šå…è®¸é«˜åˆ†è¾¨ç‡æ—¶é—´æµ‹é‡ã€‚é«˜åˆ†è¾¨ç‡æ—¶é—´å¯ç”¨äºå®šæ—¶æ”»å‡»å’ŒæŒ‡çº¹è¯†åˆ«ã€‚

--allow-net=<allow-net>ï¼šå…è®¸ç½‘ç»œè®¿é—®ã€‚æ‚¨å¯ä»¥æŒ‡å®šä¸€ä¸ªå¯é€‰çš„ã€ä»¥é€—å·åˆ†éš”çš„ IP åœ°å€æˆ–ä¸»æœºååˆ—è¡¨ï¼ˆå¯é€‰ä¸ç«¯å£ï¼‰ï¼Œä»¥æä¾›å…è®¸çš„ç½‘ç»œåœ°å€çš„å…è®¸åˆ—è¡¨ã€‚
ä¾‹å­ï¼š
--allow-net=[2606:4700:4700::1111]ã€--allow-net=1.1.1.1:443ã€--allow-net=deno.land:80ã€--allow-net=github.com,deno.landã€--allow-netï¼ˆè¡¨ç¤ºå…è®¸ä»»ä½•çš„ï¼‰

--allow-ffiï¼šå…è®¸åŠ è½½åŠ¨æ€åº“ã€‚è¯·æ³¨æ„ï¼ŒåŠ¨æ€åº“ä¸åœ¨æ²™ç®±ä¸­è¿è¡Œï¼Œå› æ­¤æ²¡æœ‰ä¸ Deno è¿›ç¨‹ç›¸åŒçš„å®‰å…¨é™åˆ¶ã€‚å› æ­¤ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚è¯·æ³¨æ„ --allow-ffi æ˜¯ä¸€ä¸ªä¸ç¨³å®šçš„åŠŸèƒ½ã€‚

--allow-read=<allow-read>ï¼šå…è®¸æ–‡ä»¶ç³»ç»Ÿè¯»å–è®¿é—®ã€‚æ‚¨å¯ä»¥æŒ‡å®šä¸€ä¸ªå¯é€‰çš„ã€ä»¥é€—å·åˆ†éš”çš„ç›®å½•æˆ–æ–‡ä»¶åˆ—è¡¨ï¼Œä»¥æä¾›å…è®¸çš„æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™åˆ—è¡¨ã€‚
ä¾‹å­ï¼š
--allow-read=/usrã€--allow-read=/etc

--allow-run=<allow-run>ï¼šå…è®¸è¿è¡Œå­è¿›ç¨‹ã€‚ä» Deno 1.9 å¼€å§‹ï¼Œæ‚¨å¯ä»¥æŒ‡å®šä¸€ä¸ªå¯é€‰çš„ã€ä»¥é€—å·åˆ†éš”çš„å­è¿›ç¨‹åˆ—è¡¨ï¼Œä»¥æä¾›å…è®¸çš„å­è¿›ç¨‹çš„å…è®¸åˆ—è¡¨ã€‚
è¯·æ³¨æ„ï¼Œå­è¿›ç¨‹ä¸åœ¨æ²™ç®±ä¸­è¿è¡Œï¼Œå› æ­¤æ²¡æœ‰ä¸ Deno è¿›ç¨‹ç›¸åŒçš„å®‰å…¨é™åˆ¶ã€‚å› æ­¤ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚
å­è¿›ç¨‹éå¸¸å¼ºå¤§ï¼Œè€Œä¸”å¯èƒ½æœ‰ç‚¹å“äººï¼šå®ƒä»¬è®¿é—®ç³»ç»Ÿèµ„æºï¼Œè€Œä¸ç®¡ä½ æˆäºˆç”Ÿæˆå®ƒä»¬çš„ Deno è¿›ç¨‹çš„æƒé™å¦‚ä½•ã€‚
unix ç³»ç»Ÿä¸Šçš„ cat ç¨‹åºå¯ç”¨äºä»ç£ç›˜è¯»å–æ–‡ä»¶ã€‚å¦‚æœä½ é€šè¿‡ Deno.run API å¯åŠ¨è¿™ä¸ªç¨‹åºï¼Œå³ä½¿çˆ¶ Deno è¿›ç¨‹ä¸èƒ½ç›´æ¥è¯»å–æ–‡ä»¶ï¼Œå®ƒä¹Ÿå¯ä»¥ä»ç£ç›˜è¯»å–æ–‡ä»¶ã€‚
è¿™é€šå¸¸è¢«ç§°ä¸ºç‰¹æƒå‡çº§ã€‚
å› æ­¤ï¼Œè¯·åŠ¡å¿…ä»”ç»†è€ƒè™‘æ˜¯å¦è¦æˆäºˆç¨‹åº --allow-run è®¿é—®æƒé™ï¼šå®ƒå®è´¨ä¸Šä¼šä½¿ Deno å®‰å…¨æ²™ç®±æ— æ•ˆã€‚
å¦‚æœä½ çœŸçš„éœ€è¦ç”Ÿæˆä¸€ä¸ªç‰¹å®šçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½ å¯ä»¥é€šè¿‡å°†ç‰¹å®šçš„å¯æ‰§è¡Œæ–‡ä»¶åç§°ä¼ é€’ç»™ --allow-run æ ‡å¿—æ¥é™åˆ¶Denoè¿›ç¨‹å¯ä»¥å¯åŠ¨å“ªäº›ç¨‹åºæ¥é™ä½é£é™©ã€‚
æ‚¨åªèƒ½é™åˆ¶å…è®¸çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼›å¦‚æœæˆäºˆæ‰§è¡Œå®ƒçš„æƒé™ï¼Œåˆ™å¯ä»¥ä¼ é€’ä»»ä½•å‚æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨ä¼ é€’ --allow-run=cat åˆ™ç”¨æˆ·å¯ä»¥ä½¿ç”¨ cat è¯»å–ä»»ä½•æ–‡ä»¶ã€‚
ä¾‹å­ï¼š
--allow-run=whoamiã€--allow-runï¼ˆè¡¨ç¤ºå…è®¸ä»»ä½•çš„ï¼‰
// run.js
const proc = Deno.run({ cmd: ["whoami"] });

--allow-write=<allow-write>ï¼šå…è®¸æ–‡ä»¶ç³»ç»Ÿå†™è®¿é—®ã€‚æ‚¨å¯ä»¥æŒ‡å®šä¸€ä¸ªå¯é€‰çš„ã€ä»¥é€—å·åˆ†éš”çš„ç›®å½•æˆ–æ–‡ä»¶åˆ—è¡¨ï¼Œä»¥æä¾›å…è®¸çš„æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™åˆ—è¡¨ã€‚

-Aã€--allow-allï¼šå…è®¸æ‰€æœ‰æƒé™ã€‚è¿™å°†å¯ç”¨æ‰€æœ‰å®‰å…¨æ•æ„ŸåŠŸèƒ½ã€‚è°¨æ…ä½¿ç”¨ã€‚



è°ƒè¯•Deno
è¦æ¿€æ´»è°ƒè¯•åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨ --inspect æˆ– --inspect-brk æ ‡å¿—è¿è¡Œ Denoã€‚



è¿è¡Œæ—¶
æ‰€æœ‰è¿è¡Œæ—¶å‡½æ•°ï¼ˆWeb API + Deno å…¨å±€ï¼‰çš„æ–‡æ¡£éƒ½å¯ä»¥åœ¨ doc.deno.land/deno/stable ä¸Šæ‰¾åˆ°ï¼Œå…¶ä¸­ä¸ç¨³å®šçš„ API æ˜¯é€šè¿‡ doc.deno.land/deno/unstable ä¸­çš„ --unstable æ ‡å¿—å¯ç”¨çš„ã€‚
Web Platform APIsï¼ˆåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç¨å¾®åç¦»è§„èŒƒæ˜¯æœ‰æ„ä¹‰çš„ï¼Œå› ä¸º Deno å…·æœ‰ä¸åŒçš„å®‰å…¨æ¨¡å‹ã€‚ï¼‰ï¼šå¯¹äºå·²ç»å­˜åœ¨ Web æ ‡å‡†çš„ APIï¼Œä¾‹å¦‚ HTTP è¯·æ±‚çš„ fetchï¼ŒDeno ä½¿ç”¨è¿™äº›è€Œä¸æ˜¯å‘æ˜æ–°çš„ä¸“æœ‰ APIã€‚
https://deno.land/manual@v1.27.0/runtime/web_platform_apis
Deno globalï¼šæ‰€æœ‰é Web æ ‡å‡†çš„ API éƒ½åŒ…å«åœ¨å…¨å±€ Deno å‘½åç©ºé—´ä¸­ã€‚å®ƒå…·æœ‰ç”¨äºè¯»å–æ–‡ä»¶ã€æ‰“å¼€ TCP å¥—æ¥å­—ã€æœåŠ¡ HTTP å’Œæ‰§è¡Œå­è¿›ç¨‹ç­‰çš„ APIã€‚
https://github.com/denoland/deno/blob/v1.27.0/cli/dts/lib.deno.ns.d.ts



Deno æ”¯æŒä¸æµè§ˆå™¨å…¼å®¹çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼šloadï¼ˆåŠ è½½åï¼‰ã€beforeunloadï¼ˆå¸è½½å‰ï¼‰ å’Œ unloadï¼ˆå¸è½½åï¼‰ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›äº‹ä»¶åœ¨ç¨‹åºä¸­æä¾›è®¾ç½®å’Œæ¸…ç†ä»£ç ã€‚
loadäº‹ä»¶çš„ç›‘å¬å™¨å¯ä»¥æ˜¯å¼‚æ­¥çš„å¹¶ä¸”ä¼šè¢«ç­‰å¾…ï¼Œè¿™ä¸ªäº‹ä»¶ä¸èƒ½è¢«å–æ¶ˆã€‚
beforeunloadçš„ç›‘å¬å™¨éœ€è¦åŒæ­¥å¹¶ä¸”å¯ä»¥è¢«å–æ¶ˆä»¥ä¿æŒç¨‹åºè¿è¡Œã€‚
unloadäº‹ä»¶çš„ç›‘å¬å™¨éœ€è¦åŒæ­¥ä¸”ä¸èƒ½å–æ¶ˆã€‚
ä½¿ç”¨ addEventListener æ·»åŠ çš„æ‰€æœ‰ä¾¦å¬å™¨éƒ½å·²æŒ‰ä»£ç çš„ç¼–å†™é¡ºåºè¿è¡Œï¼Œä½† main.ts ä¸­å®šä¹‰çš„ onloadã€onbeforeunload å’Œ onunload è¦†ç›–äº†imported.ts ä¸­å®šä¹‰çš„å¤„ç†ç¨‹åºï¼ˆåé¢çš„ä¼šè¦†ç›–å‰é¢çš„ï¼‰ã€‚
æ¢å¥è¯è¯´ï¼Œä½ å¯ä»¥ä½¿ç”¨ addEventListener æ³¨å†Œå¤šä¸ªâ€œloadâ€æˆ–â€œunloadâ€äº‹ä»¶å¤„ç†ç¨‹åºï¼Œå®ƒä»¬ä¼šæŒ‰é¡ºåºå…¨éƒ¨æ‰§è¡Œï¼Œä½†åªä¼šæ‰§è¡Œæœ€åå®šä¹‰çš„ onloadã€onbeforeunloadã€onunload äº‹ä»¶å¤„ç†ç¨‹åºï¼ˆåé¢çš„ä¼šè¦†ç›–å‰é¢çš„ï¼‰ã€‚
å‡ºäºè¿™ä¸ªåŸå› ï¼Œæœ€å¥½å°½å¯èƒ½ä½¿ç”¨addEventListenerç»‘å®šäº‹ä»¶ã€‚
ä¾‹å­ï¼š
const handler = (e: Event): void => {
  console.log(`got ${e.type} event in event handler (imported)`);
};
globalThis.addEventListener("load", handler);
globalThis.addEventListener("beforeunload", handler);
globalThis.addEventListener("unload", handler);
addEventListener å’Œ onload/onunload ä»¥ globalThis ä¸ºå‰ç¼€ï¼Œä½†æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ self æˆ–æ ¹æœ¬ä¸ä½¿ç”¨å‰ç¼€ã€‚ä¸å»ºè®®ä½¿ç”¨ window ä½œä¸ºå‰ç¼€ã€‚



åœ¨ä»£ç ä¸­æŸ¥è¯¢æƒé™ï¼šDeno.permissions.query
è¯¦ç»†è§ï¼šhttps://deno.land/api@v1.27.0?s=Deno.PermissionDescriptorï¼Œæœ‰ï¼š
runï¼šæœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼šcommand: string | URLã€
readï¼šæœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼špath: string | URLã€
writeï¼šæœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼špath: string | URLã€
netï¼šæœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼šhost: stringï¼ˆ"<hostname>[:<port>]"ï¼‰ã€
envï¼šæœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼švariable: stringã€
sysï¼šæœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼škind: "loadavg"ã€"hostname"ã€"systemMemoryInfo"ã€"networkInterfaces"ã€"osRelease"ã€"uid"ã€"gid"ã€
ffiï¼šæœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼špath: string | URLã€
hrtimeï¼šæ— ç¬¬äºŒä¸ªå‚æ•°ã€‚

{ state: "granted" }ï¼šè¿™ç±»è¡¨ç¤ºä»CLIä¸­æœ‰æ˜ç¡®æˆäºˆçš„æƒé™ã€‚
{ state: "prompt" }ï¼šè¿™ç±»è¡¨ç¤ºéœ€è¦æç¤ºæ˜¯å¦è¦æˆæƒè¯»è¿™ä¸ªæ–‡ä»¶å¤¹çš„æƒé™ã€‚
{ state: "denied" }ï¼šè¿™ç±»è¡¨ç¤ºæ˜ç¡®æ‹’ç»æˆäºˆçš„æƒé™ã€‚
ä¾‹å­1ï¼š
// deno run --allow-read=/foo main.ts
const desc1 = { name: "read", path: "/foo" } as const;
console.log(await Deno.permissions.query(desc1));
// PermissionStatus { state: "granted" }ï¼Œè¡¨ç¤ºæ˜ç¡®æˆæƒã€‚
ä¾‹å­2ï¼š
const desc2 = { name: "read", path: "/foo/bar" } as const;
console.log(await Deno.permissions.query(desc2));
// PermissionStatus { state: "granted" }ï¼Œè¡¨ç¤ºæ˜ç¡®æˆæƒã€‚
ä¾‹å­3ï¼š
const desc3 = { name: "read", path: "/bar" } as const;
console.log(await Deno.permissions.query(desc3));
// PermissionStatus { state: "prompt" }ï¼Œè¡¨ç¤ºéœ€è¦æç¤ºæ˜¯å¦è¦æˆæƒè¯»è¿™ä¸ªæ–‡ä»¶å¤¹çš„æƒé™ã€‚

è®¸å¯å¼ºåº¦ï¼š
const desc1 = { name: "write" } as const;
// å¼ºäºï¼Œè¡¨ç¤ºä¸Šé¢çš„å¦‚æœæ˜¯æˆæƒçŠ¶æ€ï¼Œä¸‹é¢çš„ä¸€å®šä¹Ÿæ˜¯æˆæƒçŠ¶æ€çš„ã€‚
const desc2 = { name: "write", path: "/foo" } as const;
const desc3 = { name: "net", host: "127.0.0.1" } as const;
// å¼ºäºï¼Œè¡¨ç¤ºä¸Šé¢çš„å¦‚æœæ˜¯æˆæƒçŠ¶æ€ï¼Œä¸‹é¢çš„ä¸€å®šä¹Ÿæ˜¯æˆæƒçŠ¶æ€çš„ã€‚
const desc4 = { name: "net", host: "127.0.0.1:8000" } as const;

è¯·æ±‚æƒé™ï¼šDeno.permissions.request
é€šè¿‡CLIæç¤ºå‘ç”¨æˆ·è¯·æ±‚æœªæˆäºˆçš„æƒé™ã€‚
ä¾‹å­ï¼š
const desc1 = { name: "read", path: "/foo" } as const;
const status1 = await Deno.permissions.request(desc1);
// âš  Deno requests read access to "/foo". Grant? [y/n (y = yes allow, n = no deny)] y
console.log(status1);
å¦‚æœç”¨æˆ·åœ¨å‘½ä»¤è¡Œè¾“å…¥â€œy/yesâ€ï¼Œé‚£å°±è¡¨ç¤ºåŒæ„æˆæƒï¼Œåˆ™ä¼šè¿”å›å¦‚ä¸‹ï¼š
// PermissionStatus { state: "granted" }
å¦‚æœç”¨æˆ·åœ¨å‘½ä»¤è¡Œè¾“å…¥â€œn/noâ€ï¼Œé‚£å°±è¡¨ç¤ºä¸åŒæ„æˆæƒï¼Œåˆ™ä¼šè¿”å›å¦‚ä¸‹ï¼š
// PermissionStatus { state: "denied" }
å¦‚æœå½“å‰æƒé™çŠ¶æ€å·²ç»æ˜¯â€œgrantedâ€æˆ–â€œdeniedâ€ï¼Œåˆ™Deno.permissions.requestçš„è¡Œä¸ºç±»ä¼¼äºDeno.permissions.queryå¹¶ä»…è¿”å›å½“å‰çŠ¶æ€ã€‚è¿™å¯ä»¥é˜²æ­¢æç¤ºå·²æˆäºˆæƒé™å’Œå…ˆå‰æ‹’ç»çš„è¯·æ±‚ã€‚

æ’¤é”€æƒé™ï¼šDeno.permissions.revoke
å°†æƒé™ä»â€œgrantedâ€é™çº§ä¸ºâ€œpromptâ€ã€‚
// deno run --allow-read=/foo main.ts
const desc = { name: "read", path: "/foo" } as const;
console.log(await Deno.permissions.revoke(desc));
// PermissionStatus { state: "prompt" }
å½“æ‚¨å°è¯•æ’¤æ¶ˆä¸åœ¨ CLI ä¸Šæˆäºˆçš„æƒé™ä¸ç›¸å…³çš„æƒé™æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
// deno run --allow-read=/foo main.ts
const desc = { name: "read", path: "/foo/bar" } as const;
console.log(await Deno.permissions.revoke(desc));
// PermissionStatus { state: "prompt" }
const cliDesc = { name: "read", path: "/foo" } as const;
console.log(await Deno.permissions.revoke(cliDesc));
// PermissionStatus { state: "prompt" }
CLI æˆäºˆçš„æƒé™ï¼ˆè¿™æ„å‘³ç€å·²æ’¤é”€çš„æƒé™ï¼‰ä¹Ÿè¢«æ’¤é”€ã€‚



Worker
ç›®å‰ Deno ä»…æ”¯æŒæ¨¡å—ç±»å‹çš„ workerï¼›å› æ­¤ï¼Œåœ¨åˆ›å»ºæ–°å·¥ä½œäººå‘˜æ—¶å¿…é¡»ä¼ é€’ type: "module" é€‰é¡¹ã€‚
Denoå…è®¸å°†è„šæœ¬ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µä¸‹ï¼Œé‚£ä¸ªè„šæœ¬ä¸­ä¸å¯ä»¥ä½¿ç”¨Workerï¼Œå› ä¸ºè¿™ç§æƒ…å†µWorkeræ˜¯æ— æ³•åœ¨å…¶ä¸­è¿è¡Œå·¥ä½œï¼Œç›®å‰è¿˜æœ‰ï¼šDynamic Importsã€Web Storage APIï¼ˆlocalStorageã€sessionStorageï¼‰ä¹Ÿæ— æ³•åœ¨å…¶ä¸­è¿è¡Œå·¥ä½œã€‚
Workerä½¿ç”¨ä¾‹å­ï¼š
// Goodå¥½çš„ã€æ¨èçš„å†™æ³•ã€‚
new Worker(new URL("./worker.js", import.meta.url).href, { type: "module" });
// Badä¸å¥½çš„ã€åçš„ã€ä¸æ¨èçš„å†™æ³•ã€‚
new Worker(new URL("./worker.js", import.meta.url).href);
new Worker(new URL("./worker.js", import.meta.url).href, { type: "classic" });
new Worker("./worker.js", { type: "module" });

ä¸å¸¸è§„æ¨¡å—ä¸€æ ·ï¼Œæ‚¨å¯ä»¥åœ¨å·¥ä½œæ¨¡å—ä¸­ä½¿ç”¨é¡¶çº§ç­‰å¾…ã€‚ä½†æ˜¯ï¼Œæ‚¨åº”è¯¥æ³¨æ„å§‹ç»ˆåœ¨ç¬¬ä¸€æ¬¡ç­‰å¾…ä¹‹å‰æ³¨å†Œæ¶ˆæ¯å¤„ç†ç¨‹åºï¼Œå¦åˆ™æ¶ˆæ¯å¯èƒ½ä¼šä¸¢å¤±ã€‚
è¿™ä¸æ˜¯ Deno ä¸­çš„é”™è¯¯ï¼Œå®ƒåªæ˜¯åŠŸèƒ½çš„ä¸å¹¸äº¤äº’ï¼Œå®ƒä¹Ÿå‘ç”Ÿåœ¨æ‰€æœ‰æ”¯æŒæ¨¡å—å·¥ä½œå™¨çš„æµè§ˆå™¨ä¸­ã€‚

åˆ›å»ºä¸€ä¸ªæ–°çš„ Worker å®ä¾‹ç±»ä¼¼äºåŠ¨æ€å¯¼å…¥ï¼›å› æ­¤ Deno éœ€è¦é€‚å½“çš„æƒé™æ‰èƒ½æ‰§è¡Œæ­¤æ“ä½œã€‚
å¯¹äºä½¿ç”¨æœ¬åœ°æ¨¡å—çš„å·¥äººï¼› --allow-read æƒé™æ˜¯å¿…éœ€çš„ã€‚
new Worker(new URL("./worker.ts", import.meta.url).href, { type: "module" });
å¯¹äºä½¿ç”¨è¿œç¨‹æ¨¡å—çš„å·¥ä½œäººå‘˜ï¼› --allow-net æƒé™æ˜¯å¿…éœ€çš„ã€‚
new Worker("https://example.com/worker.ts", { type: "module" });

ä» v1.22 å¼€å§‹ï¼ŒDeno å‘½åç©ºé—´é»˜è®¤åœ¨ worker èŒƒå›´å†…å¯ç”¨ã€‚è¦åœ¨æ—©æœŸç‰ˆæœ¬ä¸­å¯ç”¨å‘½åç©ºé—´ï¼Œè¯·åœ¨åˆ›å»ºæ–°å·¥ä½œè€…æ—¶ä¼ é€’ deno: { namespace: true }ã€‚
const worker = new Worker(new URL("./worker.js", import.meta.url).href, {
  type: "module",
  deno: {
    namespace: true
  },
});

ä» v1.23 å¼€å§‹ï¼ŒDeno.exit() ä¸å†ä½¿ç”¨æä¾›çš„é€€å‡ºä»£ç é€€å‡ºè¿›ç¨‹ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ self.close() çš„åˆ«åï¼Œå®ƒåªä¼šå¯¼è‡´ worker å…³é—­ã€‚
è¿™æ›´å¥½åœ°ä¸ Web å¹³å°ä¿æŒä¸€è‡´ï¼Œå› ä¸ºå·¥ä½œäººå‘˜æ— æ³•åœ¨æµè§ˆå™¨ä¸­å…³é—­é¡µé¢ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œworker å°†ä»åˆ›å»ºå®ƒçš„çº¿ç¨‹ç»§æ‰¿æƒé™ï¼Œä½†æ˜¯ä¸ºäº†å…è®¸ç”¨æˆ·é™åˆ¶è¯¥ worker çš„è®¿é—®ï¼Œæˆ‘ä»¬åœ¨ worker API ä¸­æä¾›äº† deno.permissions é€‰é¡¹ã€‚
å¯¹äºæ”¯æŒç²¾ç»†è®¿é—®çš„æƒé™ï¼Œæ‚¨å¯ä»¥ä¼ å…¥å·¥ä½œäººå‘˜å¯ä»¥è®¿é—®çš„æ‰€éœ€èµ„æºçš„åˆ—è¡¨ï¼Œå¯¹äºåªæœ‰å¼€/å…³é€‰é¡¹çš„æƒé™ï¼Œæ‚¨å¯ä»¥åˆ†åˆ«ä¼ é€’ true/falseã€‚
const worker = new Worker(new URL("./worker.js", import.meta.url).href, {
  type: "module",
  deno: {
    permissions: {
      net: [
        "https://deno.land/",
      ],
      read: [
        new URL("./file_1.txt", import.meta.url),
        new URL("./file_2.txt", import.meta.url),
      ],
      write: false,
    },
  },
});
ç²’åº¦è®¿é—®æƒé™åŒæ—¶æ¥æ”¶ç»å¯¹å’Œç›¸å¯¹è·¯ç”±ä½œä¸ºå‚æ•°ï¼Œä½†æ˜¯è¦è€ƒè™‘åˆ°ç›¸å¯¹è·¯ç”±å°†ç›¸å¯¹äºå®ä¾‹åŒ–å·¥ä½œç¨‹åºçš„æ–‡ä»¶è€Œä¸æ˜¯å·¥ä½œç¨‹åºæ–‡ä»¶å½“å‰æ‰€åœ¨çš„è·¯å¾„è¿›è¡Œè§£æ
const worker = new Worker(
  new URL("./worker/worker.js", import.meta.url).href,
  {
    type: "module",
    deno: {
      permissions: {
        read: [
          "/home/user/Documents/deno/worker/file_1.txt",
          "./worker/file_2.txt",
        ],
      },
    },
  },
);
deno.permissions åŠå…¶å­çº§éƒ½æ”¯æŒ"inherit"é€‰é¡¹ï¼Œè¿™æ„å‘³ç€å®ƒå°†å€Ÿç”¨å…¶çˆ¶çº§æƒé™ã€‚
// è¯¥å·¥ä½œäººå‘˜å°†ç»§æ‰¿å…¶çˆ¶æƒé™
const worker = new Worker(new URL("./worker.js", import.meta.url).href, {
  type: "module",
  deno: {
    permissions: "inherit",
  },
});
// è¯¥å·¥ä½œäººå‘˜å°†ä»…ç»§æ‰¿å…¶çˆ¶çº§çš„ç½‘ç»œæƒé™
const worker = new Worker(new URL("./worker.js", import.meta.url).href, {
  type: "module",
  deno: {
    permissions: {
      env: false,
      hrtime: false,
      net: "inherit",
      ffi: false,
      read: false,
      run: false,
      write: false,
    },
  },
});
ä¸æŒ‡å®š deno.permissions é€‰é¡¹æˆ–å…¶å­é€‰é¡¹ä¹‹ä¸€å°†å¯¼è‡´å·¥ä½œäººå‘˜é»˜è®¤ç»§æ‰¿ã€‚
// è¯¥å·¥ä½œäººå‘˜å°†ç»§æ‰¿å…¶çˆ¶æƒé™
const worker = new Worker(new URL("./worker.js", import.meta.url).href, {
  type: "module",
});
// è¯¥å·¥ä½œäººå‘˜å°†ç»§æ‰¿å…¶çˆ¶ BUT ç½‘ç»œçš„æ‰€æœ‰æƒé™
const worker = new Worker(new URL("./worker.js", import.meta.url).href, {
  type: "module",
  deno: {
    permissions: {
      net: false,
    },
  },
});
æ‚¨å¯ä»¥é€šè¿‡å°†â€œnoneâ€ä¼ é€’ç»™ deno.permissions é€‰é¡¹æ¥ä¸€èµ·ç¦ç”¨å·¥ä½œäººå‘˜çš„æƒé™ã€‚
// æ­¤å·¥ä½œäººå‘˜ä¸ä¼šå¯ç”¨ä»»ä½•æƒé™
const worker = new Worker(new URL("./worker.js", import.meta.url).href, {
  type: "module",
  deno: {
    permissions: "none",
  },
});



ä» Deno 1.13 åŠæ›´é«˜ç‰ˆæœ¬å¼€å§‹ï¼ŒFFIï¼ˆå¤–éƒ¨å‡½æ•°æ¥å£ï¼‰API å…è®¸ç”¨æˆ·ä½¿ç”¨ Deno.dlopen è°ƒç”¨ä»¥æ”¯æŒ C ABIs (C/C++, Rust, Zigç­‰ç­‰)çš„æœ¬åœ°è¯­è¨€ç¼–å†™çš„åº“ã€‚
https://deno.land/manual@v1.27.0/runtime/ffi_api#usage
éé˜»å¡ FFIï¼š
åœ¨è®¸å¤šç”¨ä¾‹ä¸­ï¼Œç”¨æˆ·å¯èƒ½å¸Œæœ›åœ¨åå°è¿è¡Œå— CPU é™åˆ¶çš„ FFI å‡½æ•°ï¼Œè€Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ä¸Šçš„å…¶ä»–ä»»åŠ¡ã€‚
ä» Deno 1.15 å¼€å§‹ï¼Œå¯ä»¥åœ¨ Deno.dlopen ä¸­å°†ç¬¦å·æ ‡è®°ä¸ºéé˜»å¡ã€‚è¿™äº›å‡½æ•°è°ƒç”¨å°†åœ¨ä¸“ç”¨çš„é˜»å¡çº¿ç¨‹ä¸Šè¿è¡Œï¼Œå¹¶å°†è¿”å›ä¸€ä¸ª Promise è§£æä¸ºæ‰€éœ€çš„ç»“æœã€‚
https://deno.land/manual@v1.27.0/runtime/ffi_api#non-blocking-ffi
Deno FFI API æ”¯æŒä» JavaScript å‡½æ•°åˆ›å»º C å›è°ƒï¼Œä»¥ä¾¿ä»åŠ¨æ€åº“å›è°ƒåˆ° Denoã€‚å¦‚ä½•åˆ›å»ºå’Œä½¿ç”¨å›è°ƒçš„ç¤ºä¾‹å¦‚ä¸‹ï¼š
https://deno.land/manual@v1.27.0/runtime/ffi_api#callbacks



é‡æ–°åŠ è½½æ¨¡å—
é»˜è®¤æƒ…å†µä¸‹ï¼Œç¼“å­˜ä¸­çš„æ¨¡å—å°†è¢«é‡ç”¨ï¼Œè€Œæ— éœ€è·å–æˆ–é‡æ–°ç¼–è¯‘å®ƒã€‚æœ‰æ—¶è¿™æ˜¯ä¸å¯å–çš„ï¼Œæ‚¨å¯ä»¥å¼ºåˆ¶ deno é‡æ–°è·å–æ¨¡å—å¹¶å°†å…¶é‡æ–°ç¼–è¯‘åˆ°ç¼“å­˜ä¸­ã€‚
æ‚¨å¯ä»¥ä½¿ç”¨ deno cache å­å‘½ä»¤çš„ --reload æ ‡å¿—ä½¿æœ¬åœ° DENO_DIR ç¼“å­˜æ— æ•ˆã€‚å®ƒçš„ç”¨æ³•æè¿°å¦‚ä¸‹ï¼š
deno cache --reload my_module.ts
é‡æ–°åŠ è½½ç‰¹å®šæ¨¡å—ï¼š
æœ‰æ—¶æˆ‘ä»¬åªæƒ³å‡çº§ä¸€äº›æ¨¡å—ã€‚æ‚¨å¯ä»¥é€šè¿‡å°†å‚æ•°ä¼ é€’ç»™ --reload æ ‡å¿—æ¥æ§åˆ¶å®ƒã€‚
deno cache --reload=https://deno.land/std@0.161.0 my_module.ts
deno cache --reload=https://deno.land/std@0.161.0/fs/copy.ts,https://deno.land/std@0.161.0/fmt/colors.ts my_module.ts



è¿è¡Œæ—¶éªŒè¯
æ‚¨è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨ --cached-only æ ‡å¿—æ¥è¦æ±‚è¿œç¨‹ä¾èµ–é¡¹å·²ç»è¢«ç¼“å­˜ï¼Œä»è€Œæ›´è¿›ä¸€æ­¥ã€‚
deno run --lock=./deno.lock --cached-only mod.ts
å¦‚æœ mod.ts çš„ä¾èµ–å…³ç³»æ ‘ä¸­æœ‰ä»»ä½•å°šæœªç¼“å­˜çš„ä¾èµ–å…³ç³»ï¼Œè¿™å°†å¤±è´¥ã€‚



å¯¼å…¥æ˜ å°„ï¼Œç±»ä¼¼webpackçš„â€œaliasâ€è·¯å¾„åˆ«åï¼Œç”¨äºimportæ–‡ä»¶æ—¶fromå¯¹åº”çš„è·¯å¾„åˆ«åã€‚
æ‚¨å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨importMapé€‰é¡¹ã€CLIçš„æ ‡å¿—--import-map=<FILE> æ¥è®¾ç½®å¯¼å…¥æ˜ å°„ï¼Œä¸¤è€…éƒ½è®¾ç½®æ—¶ï¼ŒCLIçš„æ ‡å¿—--import-map=<FILE>æ¯”é…ç½®æ–‡ä»¶ä¸­çš„importMapé€‰é¡¹æ›´ä¼˜å…ˆã€‚
import_map.json
{
  "imports": {
    "fmt/": "https://deno.land/std@0.161.0/fmt/"
  }
}
color.ts
import { red } from "fmt/colors.ts";
console.log(red("hello world"));

è¦å°†é¡¹ç›®æ ¹ç›®å½•ç”¨äºç»å¯¹å¯¼å…¥ï¼š
import_map.json
{
  "imports": {
    "/": "./",  // å®é™…ä½¿ç”¨ä¼šæŠ¥é”™ï¼ï¼ï¼
    "./": "./"
  }
}
main.ts
import { MyUtil } from "/util.ts";
è¿™ä¼šå¯¼è‡´ä»¥ / å¼€å¤´çš„å¯¼å…¥è¯´æ˜ç¬¦ç›¸å¯¹äºâ€œimport_map.jsonâ€çš„ URL æˆ–æ–‡ä»¶è·¯å¾„è¿›è¡Œè§£æã€‚
å¦‚æœä¸º"/": "./src/"ï¼Œé‚£ä¹ˆä»¥ / å¼€å¤´çš„å¯¼å…¥è¯´æ˜ç¬¦ç›¸å¯¹äºè·Ÿâ€œimport_map.jsonâ€åŒçº§çš„srcæ–‡ä»¶å¤¹ä¸‹çš„å­çº§æ–‡ä»¶å¤¹ã€‚



å…³äºç¼–è¯‘ç±»å‹æç¤º
å¦‚æœè¦å¯¼å…¥JavaScriptæ¨¡å—ï¼Œå¹¶ä¸”çŸ¥é“è¯¥æ¨¡å—çš„ç±»å‹å®šä¹‰ä½äºä½•å¤„ï¼Œåˆ™å¯ä»¥åœ¨å¯¼å…¥æ—¶æŒ‡å®šç±»å‹å®šä¹‰ã€‚è¿™é‡‡ç”¨ç¼–è¯‘å™¨æç¤ºçš„å½¢å¼ã€‚
PS:
// @deno-types="./foo.d.ts"
import * as foo from "./foo.js";

ä½¿ç”¨ä¸‰æ–œæ å¼•ç”¨æŒ‡ä»¤ï¼š
Deno æ”¯æŒä½¿ç”¨ä¸‰æ–œæ å¼•ç”¨ç±»å‹æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤é‡‡ç”¨ TypeScript åœ¨ TypeScript æ–‡ä»¶ä¸­ä½¿ç”¨çš„å¼•ç”¨æ³¨é‡Šæ¥åŒ…å«å…¶ä»–æ–‡ä»¶ï¼Œ
å¹¶ä¸”ä»…é€‚ç”¨äº JavaScript æ–‡ä»¶ï¼ï¼ï¼
ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘åˆ›å»ºäº†coolLib.jsï¼Œå¹¶ä¸”åœ¨coolLib.d.ts ä¸­ä¸ºæˆ‘çš„åº“åˆ›å»ºäº†ç±»å‹å®šä¹‰ï¼Œæˆ‘å¯ä»¥åœ¨coolLib.js æ–‡ä»¶ä¸­æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
æœ‰ä¸€ä¸ªcoolLib.jsæ–‡ä»¶ï¼Œé‡Œé¢çš„ä»£ç æœ‰å¦‚ä¸‹å†…å®¹ï¼š
/// <reference types="./coolLib.d.ts" />
// ... JavaScript çš„å…¶ä½™éƒ¨åˆ† ...
å½“ Deno é‡åˆ°è¿™ä¸ªæŒ‡ä»¤æ—¶ï¼Œå®ƒä¼šè§£æ ./coolLib.d.ts æ–‡ä»¶å¹¶åœ¨ TypeScript å¯¹æ–‡ä»¶è¿›è¡Œç±»å‹æ£€æŸ¥æ—¶ä½¿ç”¨è¯¥æ–‡ä»¶è€Œä¸æ˜¯ JavaScript æ–‡ä»¶ï¼Œä½†åœ¨è¿è¡Œç¨‹åºæ—¶ä»ä¼šåŠ è½½ JavaScript æ–‡ä»¶ã€‚
è¯·æ³¨æ„ï¼Œè¿™æ˜¯é’ˆå¯¹ TypeScript çš„é‡æ–°è°ƒæ•´æŒ‡ä»¤ï¼Œä»…é€‚ç”¨äº JavaScript æ–‡ä»¶ã€‚åœ¨ TypeScript æ–‡ä»¶ä¸­ä½¿ç”¨ç±»å‹çš„ä¸‰æ–œæ å¼•ç”¨æŒ‡ä»¤ä¹Ÿé€‚ç”¨äº Denoï¼Œä½†å…¶è¡Œä¸ºä¸è·¯å¾„æŒ‡ä»¤åŸºæœ¬ç›¸åŒã€‚

ä½¿ç”¨ X-TypeScript-Types æ ‡å¤´
ä¸ä¸‰æ–œæ æŒ‡ä»¤ç±»ä¼¼ï¼ŒDeno æ”¯æŒè¿œç¨‹æ¨¡å—çš„æ ‡å¤´ï¼Œè¯¥æ ‡å¤´æŒ‡ç¤º Deno åœ¨å“ªé‡Œå®šä½ç»™å®šæ¨¡å—çš„ç±»å‹ã€‚
ä¾‹å¦‚ï¼Œå¯¹ https://example.com/coolLib.js çš„å“åº”å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š
HTTP/1.1 200 OK
Content-Type: application/javascript; charset=UTF-8
Content-Length: 648
X-TypeScript-Types: ./coolLib.d.ts
å½“çœ‹åˆ°æ­¤æ ‡å¤´æ—¶ï¼ŒDeno å°†å°è¯•æ£€ç´¢ https://example.com/coolLib.d.ts å¹¶åœ¨æ£€æŸ¥åŸå§‹æ¨¡å—æ—¶ä½¿ç”¨å®ƒã€‚

ä½¿ç”¨ç¯å¢ƒæˆ–å…¨å±€ç±»å‹
æ€»çš„æ¥è¯´ï¼Œæœ€å¥½å°†æ¨¡å—/UMDç±»å‹å®šä¹‰ä¸Denoä¸€èµ·ä½¿ç”¨ï¼Œåœ¨Denoä¸­ï¼Œæ¨¡å—æ˜ç¡®åœ°å¯¼å…¥å®ƒæ‰€ä¾èµ–çš„ç±»å‹ã€‚æ¨¡å—åŒ–ç±»å‹å®šä¹‰å¯ä»¥é€šè¿‡åœ¨ç±»å‹å®šä¹‰ä¸­å£°æ˜å…¨å±€æ¥è¡¨ç¤ºå…¨å±€èŒƒå›´çš„æ‰©å±•ã€‚ä¾‹å¦‚ï¼š
declare global {
  var AGlobalString: string;
}
è¿™å°†ä½¿ AGlobalString åœ¨å¯¼å…¥ç±»å‹å®šä¹‰æ—¶åœ¨å…¨å±€å‘½åç©ºé—´ä¸­å¯ç”¨ã€‚
ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå½“åˆ©ç”¨å…¶ä»–ç°æœ‰ç±»å‹åº“æ—¶ï¼Œå¯èƒ½æ— æ³•åˆ©ç”¨æ¨¡å—åŒ–ç±»å‹å®šä¹‰ã€‚å› æ­¤ï¼Œæœ‰ä¸€äº›æ–¹æ³•å¯ä»¥åœ¨ç±»å‹æ£€æŸ¥ç¨‹åºä¸­åŒ…å«ä»»æ„ç±»å‹å®šä¹‰ã€‚

ä½¿ç”¨ä¸‰æ–œæ æŒ‡ä»¤
æ­¤é€‰é¡¹å°†ç±»å‹å®šä¹‰ä¸ä»£ç æœ¬èº«ç»“åˆèµ·æ¥ã€‚é€šè¿‡åœ¨æ¨¡å—ç±»å‹é™„è¿‘æ·»åŠ ä¸‰æ–œæ ç±»å‹æŒ‡ä»¤ï¼Œç±»å‹æ£€æŸ¥æ–‡ä»¶å°†åŒ…æ‹¬ç±»å‹å®šä¹‰ã€‚ä¾‹å¦‚ï¼š
/// <reference types="./types.d.ts" />
æä¾›çš„è¯´æ˜ç¬¦ä¸ Deno ä¸­çš„ä»»ä½•å…¶ä»–è¯´æ˜ç¬¦ä¸€æ ·è¢«è§£æï¼Œè¿™æ„å‘³ç€å®ƒéœ€è¦æ‰©å±•ï¼Œå¹¶ä¸”ä¸å¼•ç”¨å®ƒçš„æ¨¡å—ç›¸å…³ã€‚å®ƒä¹Ÿå¯ä»¥æ˜¯å®Œå…¨é™å®šçš„ URLï¼š
/// <reference types="https://deno.land/x/pkg@1.0.0/types.d.ts" />

å¦ä¸€ç§é€‰æ‹©æ˜¯ä½¿ç”¨é…ç½®æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶è¢«é…ç½®ä¸ºåŒ…å«ç±»å‹å®šä¹‰ï¼Œæ–¹æ³•æ˜¯å‘â€œcompilerOptionsâ€æä¾›â€œtypesâ€å€¼ã€‚ä¾‹å¦‚ï¼š
{
  "compilerOptions": {
    "types": [
      "./types.d.ts",
      "https://deno.land/x/pkg@1.0.0/types.d.ts",
      "/Users/me/pkg/types.d.ts"
    ]
  }
}



å…³äºlibåº“ä¹‹é—´çš„å†²çªï¼š
"deno.worker"ä¸"deno.window"å†²çª
è§£å†³æ–¹æ¡ˆï¼š
åœ¨é…ç½®æ–‡ä»¶ä¸­çš„libé€‰é¡¹é‡ŒåŒ…å«"deno.window"ï¼Œä½†ä¸åŒ…å«"deno.worker"ã€‚
è€Œåœ¨ä½¿ç”¨workeræ—¶ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ªä½¿ç”¨äº†workerçš„è„šæœ¬ï¼Œæˆ–workerè„šæœ¬æœ¬èº«ï¼Œè¦æƒ³è®©å…¶å…·æœ‰ç±»å‹æè¿°ï¼Œåˆ™å¯ä»¥åœ¨è„šæœ¬å¼€å¤´ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤ï¼š
/// <reference no-default-lib="true" />   è¿™ä¸ªè¡¨ç¤ºä¸‹é¢çš„â€œdeno.workerâ€ä¸æ˜¯é…ç½®æ–‡ä»¶ä¸­çš„libé€‰é¡¹é‡Œçš„ç±»å‹æè¿°æ–‡ä»¶ã€‚
/// <reference lib="deno.worker" />       è¿™ä¸ªè¡¨ç¤ºä½¿ç”¨ç±»å‹æè¿°æ–‡ä»¶â€œdeno.workerâ€ã€‚

"dom.extras"ä¸"deno.url"å†²çª
ç”±äºæ˜¯ä½¿ç”¨Denoå¼€å‘ï¼Œåœ¨ä¸è€ƒè™‘æ‰€å†™çš„ä»£ç æœªæ¥è¦åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼Œé‚£ä¹ˆç›´æ¥ä½¿ç”¨"deno.url"å³å¯ï¼Œä¸ç”¨"dom.extras"ã€‚
ä¹Ÿå°±æ˜¯è¯´ï¼Œé…ç½®æ–‡ä»¶ä¸­çš„libé€‰é¡¹é‡Œåªè¦åŒ…å«"deno.url"å³å¯ï¼Œä¸è¦å†™å…¥"dom.extras"ã€‚

å¦‚æœå‘½ä»¤ä¸­ä½¿ç”¨äº†â€œ--unstableâ€æ ‡å¿—ï¼Œé‚£ä¹ˆé…ç½®æ–‡ä»¶ä¸­çš„libé€‰é¡¹é‡Œä¸€å®šå¾—è¦æœ‰"deno.window", "deno.unstable"ã€‚

"deno.window"ä¸"dom"ã€"dom.iterable"å†²çª
å‚ç…§ä¸Šé¢çš„â€œ"dom.extras"ä¸"deno.url"å†²çªâ€çš„è¯´æ˜ã€‚

è¿™äº›æ˜¯ Deno ä¸ä½¿ç”¨çš„å¸¸ç”¨åº“ï¼Œä½†åœ¨ç¼–å†™æ—¨åœ¨ä¹Ÿå¯åœ¨å¦ä¸€ä¸ªè¿è¡Œæ—¶ä¸­å·¥ä½œçš„ä»£ç æ—¶å¾ˆæœ‰ç”¨ï¼š
"dom"ã€"dom.iterable"ã€"scripthost"ã€"webworker"ã€"webworker.importscripts"ã€"webworker.iterable"
è¿™å‡ ä¸ªä¼šè·Ÿdenoçš„è‡ªèº«ç±»å‹æè¿°æ–‡ä»¶å†²çªï¼Œæ•…è€Œä¸ç”¨å®ƒä»¬ï¼Œæ¯•ç«Ÿä¸è€ƒè™‘ä»£ç åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ã€‚



å…³äºæ“ä½œDOM
LinkedDOMç”¨äºåšæœåŠ¡ç«¯æ¸²æŸ“ã€‚
deno_domåšæ ‡å‡†çš„ç¬¦åˆæµè§ˆå™¨è¿è¡Œçš„DOMæ“ä½œã€‚
jsdomä¸æ¨èä½¿ç”¨ï¼Œä¸ä»…ä¸å¦‚å‰é¢ä¸¤ä¸ªï¼Œè€Œä¸”å®ƒä¹Ÿä¸æ”¯æŒåœ¨ç»è¿‡Denoç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­è¿è¡Œï¼Œè€Œå‰é¢ä¸¤ä¸ªæ˜¯å¯ä»¥çš„ã€‚



å…³äºè°ƒè¯•deno
ä½¿ç”¨--inspect-brkå‘½ä»¤ï¼Œç„¶ååœ¨è°·æ­ŒåŠå…¶åŒç³»åˆ—çš„æµè§ˆå™¨æ‰“å¼€chrome://inspectï¼Œå¦‚æœæ²¡çœ‹åˆ°å·²ç»è¿è¡Œçš„denoæœåŠ¡ï¼Œå°±åˆ·æ–°chrome://inspecté¡µé¢ï¼Œçœ‹åˆ°åï¼Œç‚¹å‡»â€œinspectâ€å³å¯å¼€å§‹è°ƒè¯•ã€‚



Denoæ¨¡å—çš„åŠ è½½è·¯å¾„çš„æ ¼å¼åŸåˆ™
ç»å¯¹çš„URLåœ°å€(http://localhost:8081/WebProTpl/dist/Deno4TestA.js)ã€ç›¸å¯¹è·¯å¾„(å¯è¡Œï¼š'./qwe.js'ï¼Œä¸å¯è¡Œï¼š'qwe.js'ã€'qwe')
PS:
ç”±äº Deno åªæ”¯æŒä» URL åŠ è½½æ¨¡å—ï¼Œå¯¼è‡´ Node.js çš„æ¨¡å—åŠ è½½å†™æ³•éƒ½ä¼šå¤±æ•ˆã€‚
import React from "react";
import { Box, Grid } from "@material-ui/core";
import { initializeApp } from "firebase/app";
ä¸Šé¢çš„å†™æ³•åœ¨ Deno é‡Œé¢éƒ½æ˜¯éæ³•çš„ã€‚



deno.jsonä¸­å¦‚æœè®¾ç½®äº†è·Ÿtsconfig.jsonä¸­å¤§å¤šæ•°ä¸€æ ·çš„è®¾ç½®æ—¶ï¼Œdenoåœ¨è¿è¡Œæ—¶ä¼šå‡ºç°ä»¥ä¸‹è­¦å‘Šï¼Œ
è¯´ä»¥ä¸‹é€‰é¡¹è¢«å¿½ç•¥ï¼Œä¿ç•™è¿™äº›é€‰é¡¹å³å¯ï¼Œåæ­£ä¼šè¢«å¿½ç•¥ï¼Œæœªæ¥å¯èƒ½å°±æ”¯æŒæŸäº›é€‰é¡¹äº†ï¼š
allowSyntheticDefaultImportsã€
allowUmdGlobalAccessã€
assumeChangesOnlyAffectDirectDependenciesã€
compositeã€
declarationã€
declarationMapã€
disableSizeLimitã€
downlevelIterationã€
emitBOMã€
emitDeclarationOnlyã€
esModuleInteropã€
experimentalDecoratorsã€
extendedDiagnosticsã€
forceConsistentCasingInFileNamesã€
importHelpersã€
incrementalã€
inlineSourceMapã€
inlineSourcesã€
isolatedModulesã€
listEmittedFilesã€
maxNodeModuleJsDepthã€
moduleã€
moduleDetectionã€
moduleResolutionã€
newLineã€
noEmitã€
noEmitHelpersã€
noEmitOnErrorã€
noErrorTruncationã€
noLibã€
noResolveã€
outDirã€
preserveConstEnumsã€
preserveSymlinksã€
preserveWatchOutputã€
prettyã€
resolveJsonModuleã€
skipLibCheckã€
sourceMapã€
stripInternalã€
targetã€
traceResolutionã€
tsBuildInfoFileã€
useDefineForClassFields
